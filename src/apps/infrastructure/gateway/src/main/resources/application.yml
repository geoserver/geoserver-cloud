spring:
  application.name: gateway
  config:
    import:
      - classpath:geoserver_spring_boot_profiles.yml
      - classpath:geoserver_spring_cloud_profiles.yml
  cloud:
    gateway:
      server:
        webflux:
          enabled: true
          trusted-proxies: ".*"

management:
  endpoints:
    access:
      default: read-only
    web:
      exposure:
        include: "*"
  endpoint:
    env.show-values: ALWAYS
    configprops.show-values: ALWAYS
    info:
      access: read-only
    metrics:
      access: read-only
    shutdown:
      access: none
    health:
      access: read-only
      probes:
        enabled: true
      show-details: always
    prometheus:
      access: read-only
  metrics:
    enable:
      jvm: true

# Access log configuration - log all requests by default
logging:
  level:
    # Enable debug for MDC components
    '[org.geoserver.cloud.logging.mdc]': DEBUG
    '[org.geoserver.cloud.logging.accesslog]': DEBUG
  accesslog:
    info:
      - ".*"  # Log all URLs at INFO level
  # Configure logback to include MDC in json output
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"

---
spring.config.activate.on-profile: "bootstrap-standalone"
spring.config.import: ${standalone.config.location:file:/etc/geoserver/gateway.yml}

---
spring.config.activate.on-profile: "discovery-eureka"
eureka:
  client:
    fetch-registry: true
    registry-fetch-interval-seconds: 5

---
# local profile, used for development only. Other settings like config and eureka urls in gs_cloud_bootstrap_profiles.yml
spring.config.activate.on-profile: local
server.port: 9090
management.server.port: 9090
